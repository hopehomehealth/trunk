define(function(require,exports,module){var e=require("jquery");(function(e){e.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}};var t,i;if(!e.browser){t=e.uaMatch(navigator.userAgent);i={};if(t.browser){i[t.browser]=true;i.version=t.version}if(i.chrome){i.webkit=true}else if(i.webkit){i.safari=true}e.browser=i}})(e);(function(t){var i,n,a,o,r,s,d,f,c,l,h=0,p={},u=[],g=0,b={},y=[],w=null,m=new Image,x=/\.(jpg|gif|png|bmp|jpeg)(.*)?$/i,v=/[^\.]\.(swf)\s*$/i,I,k=1,C=0,O="",j,T,S=false,A=t.extend(t("<div/>")[0],{prop:0}),D=t.browser.msie&&t.browser.version<7&&!window.XMLHttpRequest,F=function(){n.hide();m.onerror=m.onload=null;if(w){w.abort()}i.empty()},E=function(){if(false===p.onError(u,h,p)){n.hide();S=false;return}p.titleShow=false;p.width="auto";p.height="auto";i.html('<p id="fancybox-error">The requested content cannot be loaded.<br />Please try again later.</p>');B()},N=function(){var e=u[h],a,o,r,d,f,c;F();p=t.extend({},t.fn.fancybox.defaults,typeof t(e).data("fancybox")=="undefined"?p:t(e).data("fancybox"));c=p.onStart(u,h,p);if(c===false){S=false;return}else if(typeof c=="object"){p=t.extend(p,c)}r=p.title||(e.nodeName?t(e).attr("title"):e.title)||"";if(e.nodeName&&!p.orig){p.orig=t(e).children("img:first").length?t(e).children("img:first"):t(e)}if(r===""&&p.orig&&p.titleFromAlt){r=p.orig.attr("alt")}a=p.href||(e.nodeName?t(e).attr("href"):e.href)||null;if(/^(?:javascript)/i.test(a)||a=="#"){a=null}if(p.type){o=p.type;if(!a){a=p.content}}else if(p.content){o="html"}else if(a){if(a.match(x)){o="image"}else if(a.match(v)){o="swf"}else if(t(e).hasClass("iframe")){o="iframe"}else if(a.indexOf("#")===0){o="inline"}else{o="ajax"}}if(!o){E();return}if(o=="inline"){e=a.substr(a.indexOf("#"));o=t(e).length>0?"inline":"ajax"}p.type=o;p.href=a;p.title=r;if(p.autoDimensions){if(p.type=="html"||p.type=="inline"||p.type=="ajax"){p.width="auto";p.height="auto"}else{p.autoDimensions=false}}if(p.modal){p.overlayShow=true;p.hideOnOverlayClick=false;p.hideOnContentClick=false;p.enableEscapeButton=false;p.showCloseButton=false}p.padding=parseInt(p.padding,10);p.margin=parseInt(p.margin,10);i.css("padding",p.padding+p.margin);t(".fancybox-inline-tmp").unbind("fancybox-cancel").bind("fancybox-change",function(){t(this).replaceWith(s.children())});switch(o){case"html":i.html(p.content);B();break;case"inline":if(t(e).parent().is("#fancybox-content")===true){S=false;return}t('<div class="fancybox-inline-tmp" />').hide().insertBefore(t(e)).bind("fancybox-cleanup",function(){t(this).replaceWith(s.children())}).bind("fancybox-cancel",function(){t(this).replaceWith(i.children())});t(e).appendTo(i);B();break;case"image":S=false;t.fancybox.showActivity();m=new Image;m.onerror=function(){E()};m.onload=function(){S=true;m.onerror=m.onload=null;P()};m.src=a;break;case"swf":p.scrolling="no";d='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+p.width+'" height="'+p.height+'"><param name="movie" value="'+a+'"></param>';f="";t.each(p.swf,function(e,t){d+='<param name="'+e+'" value="'+t+'"></param>';f+=" "+e+'="'+t+'"'});d+='<embed src="'+a+'" type="application/x-shockwave-flash" width="'+p.width+'" height="'+p.height+'"'+f+"></embed></object>";i.html(d);B();break;case"ajax":S=false;t.fancybox.showActivity();p.ajax.win=p.ajax.success;w=t.ajax(t.extend({},p.ajax,{url:a,data:p.ajax.data||{},error:function(e,t,i){if(e.status>0){E()}},success:function(e,t,o){var r=typeof o=="object"?o:w;if(r.status==200){if(typeof p.ajax.win=="function"){c=p.ajax.win(a,e,t,o);if(c===false){n.hide();return}else if(typeof c=="string"||typeof c=="object"){e=c}}i.html(e);B()}}}));break;case"iframe":M();break}},B=function(){var e=p.width,n=p.height;if(e.toString().indexOf("%")>-1){e=parseInt((t(window).width()-p.margin*2)*parseFloat(e)/100,10)+"px"}else{e=e=="auto"?"auto":e+"px"}if(n.toString().indexOf("%")>-1){n=parseInt((t(window).height()-p.margin*2)*parseFloat(n)/100,10)+"px"}else{n=n=="auto"?"auto":n+"px"}i.wrapInner('<div style="width:'+e+";height:"+n+";overflow: "+(p.scrolling=="auto"?"auto":p.scrolling=="yes"?"scroll":"hidden")+';position:relative;"></div>');p.width=i.width();p.height=i.height();M()},P=function(){p.width=m.width;p.height=m.height;t("<img />").attr({id:"fancybox-img",src:m.src,alt:p.title}).appendTo(i);M()},M=function(){var e,r;n.hide();if(o.is(":visible")&&false===b.onCleanup(y,g,b)){t.event.trigger("fancybox-cancel");S=false;return}S=true;t(s.add(a)).unbind();t(window).unbind("resize.fb scroll.fb");t(document).unbind("keydown.fb");if(o.is(":visible")&&b.titlePosition!=="outside"){o.css("height",o.height())}y=u;g=h;b=p;if(b.overlayShow){a.css({"background-color":b.overlayColor,opacity:b.overlayOpacity,cursor:b.hideOnOverlayClick?"pointer":"auto",height:t(document).height()});if(!a.is(":visible")){if(D){t("select:not(#fancybox-tmp select)").filter(function(){return this.style.visibility!=="hidden"}).css({visibility:"hidden"}).one("fancybox-cleanup",function(){this.style.visibility="inherit"})}a.show()}}else{a.hide()}T=X();z();if(o.is(":visible")){t(d.add(c).add(l)).hide();e=o.position(),j={top:e.top,left:e.left,width:o.width(),height:o.height()};r=j.width==T.width&&j.height==T.height;s.fadeTo(b.changeFade,.3,function(){var e=function(){s.html(i.contents()).fadeTo(b.changeFade,1,R)};t.event.trigger("fancybox-change");s.empty().removeAttr("filter").css({"border-width":b.padding,width:T.width-b.padding*2,height:p.autoDimensions?"auto":T.height-C-b.padding*2});if(r){e()}else{A.prop=0;t(A).animate({prop:1},{duration:b.changeSpeed,easing:b.easingChange,step:K,complete:e})}});return}o.removeAttr("style");s.css("border-width",b.padding);if(b.transitionIn=="elastic"){j=U();s.html(i.contents());o.show();if(b.opacity){T.opacity=0}A.prop=0;t(A).animate({prop:1},{duration:b.speedIn,easing:b.easingIn,step:K,complete:R});return}if(b.titlePosition=="inside"&&C>0){f.show()}s.css({width:T.width-b.padding*2,height:p.autoDimensions?"auto":T.height-C-b.padding*2}).html(i.contents());o.css(T).fadeIn(b.transitionIn=="none"?0:b.speedIn,R)},L=function(e){if(e&&e.length){if(b.titlePosition=="float"){return'<table id="fancybox-title-float-wrap" cellpadding="0" cellspacing="0"><tr><td id="fancybox-title-float-left"></td><td id="fancybox-title-float-main">'+e+'</td><td id="fancybox-title-float-right"></td></tr></table>'}return'<div id="fancybox-title-'+b.titlePosition+'">'+e+"</div>"}return false},z=function(){O=b.title||"";C=0;f.empty().removeAttr("style").removeClass();if(b.titleShow===false){f.hide();return}O=t.isFunction(b.titleFormat)?b.titleFormat(O,y,g,b):L(O);if(!O||O===""){f.hide();return}f.addClass("fancybox-title-"+b.titlePosition).html(O).appendTo("body").show();switch(b.titlePosition){case"inside":f.css({width:T.width-b.padding*2,marginLeft:b.padding,marginRight:b.padding});C=f.outerHeight(true);f.appendTo(r);T.height+=C;break;case"over":f.css({marginLeft:b.padding,width:T.width-b.padding*2,bottom:b.padding}).appendTo(r);break;case"float":f.css("left",parseInt((f.width()-T.width-40)/2,10)*-1).appendTo(o);break;default:f.css({width:T.width-b.padding*2,paddingLeft:b.padding,paddingRight:b.padding}).appendTo(o);break}f.hide()},H=function(){if(b.enableEscapeButton||b.enableKeyboardNav){t(document).bind("keydown.fb",function(e){if(e.keyCode==27&&b.enableEscapeButton){e.preventDefault();t.fancybox.close()}else if((e.keyCode==37||e.keyCode==39)&&b.enableKeyboardNav&&e.target.tagName!=="INPUT"&&e.target.tagName!=="TEXTAREA"&&e.target.tagName!=="SELECT"){e.preventDefault();t.fancybox[e.keyCode==37?"prev":"next"]()}})}if(!b.showNavArrows){c.hide();l.hide();return}if(b.cyclic&&y.length>1||g!==0){c.show()}if(b.cyclic&&y.length>1||g!=y.length-1){l.show()}},R=function(){if(!t.support.opacity){s.get(0).style.removeAttribute("filter");o.get(0).style.removeAttribute("filter")}if(p.autoDimensions){s.css("height","auto")}o.css("height","auto");if(O&&O.length){f.show()}if(b.showCloseButton){d.show()}H();if(b.hideOnContentClick){s.bind("click",t.fancybox.close)}if(b.hideOnOverlayClick){a.bind("click",t.fancybox.close)}t(window).bind("resize.fb",t.fancybox.resize);if(b.centerOnScroll){t(window).bind("scroll.fb",t.fancybox.center)}if(b.type=="iframe"){t('<iframe id="fancybox-frame" name="fancybox-frame'+(new Date).getTime()+'" frameborder="0" hspace="0" '+(t.browser.msie?'allowtransparency="true""':"")+' scrolling="'+p.scrolling+'" src="'+b.href+'"></iframe>').appendTo(s)}o.show();S=false;t.fancybox.center();b.onComplete(y,g,b);q()},q=function(){var e,t;if(y.length-1>g){e=y[g+1].href;if(typeof e!=="undefined"&&e.match(x)){t=new Image;t.src=e}}if(g>0){e=y[g-1].href;if(typeof e!=="undefined"&&e.match(x)){t=new Image;t.src=e}}},K=function(e){var t={width:parseInt(j.width+(T.width-j.width)*e,10),height:parseInt(j.height+(T.height-j.height)*e,10),top:parseInt(j.top+(T.top-j.top)*e,10),left:parseInt(j.left+(T.left-j.left)*e,10)};if(typeof T.opacity!=="undefined"){t.opacity=e<.5?.5:e}o.css(t);s.css({width:t.width-b.padding*2,height:t.height-C*e-b.padding*2})},W=function(){return[t(window).width()-b.margin*2,t(window).height()-b.margin*2,t(document).scrollLeft()+b.margin,t(document).scrollTop()+b.margin]},X=function(){var e=W(),t={},i=b.autoScale,n=b.padding*2,a;if(b.width.toString().indexOf("%")>-1){t.width=parseInt(e[0]*parseFloat(b.width)/100,10)}else{t.width=b.width+n}if(b.height.toString().indexOf("%")>-1){t.height=parseInt(e[1]*parseFloat(b.height)/100,10)}else{t.height=b.height+n}if(i&&(t.width>e[0]||t.height>e[1])){if(p.type=="image"||p.type=="swf"){a=b.width/b.height;if(t.width>e[0]){t.width=e[0];t.height=parseInt((t.width-n)/a+n,10)}if(t.height>e[1]){t.height=e[1];t.width=parseInt((t.height-n)*a+n,10)}}else{t.width=Math.min(t.width,e[0]);t.height=Math.min(t.height,e[1])}}t.top=parseInt(Math.max(e[3]-20,e[3]+(e[1]-t.height-40)*.5),10);t.left=parseInt(Math.max(e[2]-20,e[2]+(e[0]-t.width-40)*.5),10);return t},$=function(e){var t=e.offset();t.top+=parseInt(e.css("paddingTop"),10)||0;t.left+=parseInt(e.css("paddingLeft"),10)||0;t.top+=parseInt(e.css("border-top-width"),10)||0;t.left+=parseInt(e.css("border-left-width"),10)||0;t.width=e.width();t.height=e.height();return t},U=function(){var e=p.orig?t(p.orig):false,i={},n,a;if(e&&e.length){n=$(e);i={width:n.width+b.padding*2,height:n.height+b.padding*2,top:n.top-b.padding-20,left:n.left-b.padding-20}}else{a=W();i={width:b.padding*2,height:b.padding*2,top:parseInt(a[3]+a[1]*.5,10),left:parseInt(a[2]+a[0]*.5,10)}}return i},G=function(){if(!n.is(":visible")){clearInterval(I);return}t("div",n).css("top",k*-40+"px");k=(k+1)%12};t.fn.fancybox=function(e){if(!t(this).length){return this}t(this).data("fancybox",t.extend({},e,t.metadata?t(this).metadata():{})).unbind("click.fb").bind("click.fb",function(e){e.preventDefault();if(S){return}S=true;t(this).blur();u=[];h=0;var i=t(this).attr("rel")||"";if(!i||i==""||i==="nofollow"){u.push(this)}else{u=t("a[rel="+i+"], area[rel="+i+"]");h=u.index(this)}N();return});return this};t.fancybox=function(i){var n;if(S){return}S=true;n=typeof arguments[1]!=="undefined"?arguments[1]:{};u=[];h=parseInt(n.index,10)||0;if(t.isArray(i)){for(var a=0,o=i.length;a<o;a++){if(typeof i[a]=="object"){t(i[a]).data("fancybox",t.extend({},n,i[a]))}else{i[a]=t({}).data("fancybox",t.extend({content:i[a]},n))}}u=e.merge(u,i)}else{if(typeof i=="object"){t(i).data("fancybox",t.extend({},n,i))}else{i=t({}).data("fancybox",t.extend({content:i},n))}u.push(i)}if(h>u.length||h<0){h=0}N()};t.fancybox.showActivity=function(){clearInterval(I);n.show();I=setInterval(G,66)};t.fancybox.hideActivity=function(){n.hide()};t.fancybox.next=function(){return t.fancybox.pos(g+1)};t.fancybox.prev=function(){return t.fancybox.pos(g-1)};t.fancybox.pos=function(e){if(S){return}e=parseInt(e);u=y;if(e>-1&&e<y.length){h=e;N()}else if(b.cyclic&&y.length>1){h=e>=y.length?0:y.length-1;N()}return};t.fancybox.cancel=function(){if(S){return}S=true;t.event.trigger("fancybox-cancel");F();p.onCancel(u,h,p);S=false};t.fancybox.close=function(){if(S||o.is(":hidden")){return}S=true;if(b&&false===b.onCleanup(y,g,b)){S=false;return}F();t(d.add(c).add(l)).hide();t(s.add(a)).unbind();t(window).unbind("resize.fb scroll.fb");t(document).unbind("keydown.fb");s.find("iframe").attr("src",D&&/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank");if(b.titlePosition!=="inside"){f.empty()}o.stop();function e(){a.fadeOut("fast");f.empty().hide();o.hide();t.event.trigger("fancybox-cleanup");s.empty();b.onClosed(y,g,b);y=p=[];g=h=0;b=p={};S=false}if(b.transitionOut=="elastic"){j=U();var i=o.position();T={top:i.top,left:i.left,width:o.width(),height:o.height()};if(b.opacity){T.opacity=1}f.empty().hide();A.prop=1;t(A).animate({prop:0},{duration:b.speedOut,easing:b.easingOut,step:K,complete:e})}else{o.fadeOut(b.transitionOut=="none"?0:b.speedOut,e)}};t.fancybox.resize=function(){if(a.is(":visible")){a.css("height",t(document).height())}t.fancybox.center(true)};t.fancybox.center=function(){var e,t;if(S){return}t=arguments[0]===true?1:0;e=W();if(!t&&(o.width()>e[0]||o.height()>e[1])){return}o.stop().animate({top:parseInt(Math.max(e[3]-20,e[3]+(e[1]-s.height()-40)*.5-b.padding)),left:parseInt(Math.max(e[2]-20,e[2]+(e[0]-s.width()-40)*.5-b.padding))},typeof arguments[0]=="number"?arguments[0]:200)};t.fancybox.init=function(){if(t("#fancybox-wrap").length){return}t("body").append(i=t('<div id="fancybox-tmp"></div>'),n=t('<div id="fancybox-loading"><div></div></div>'),a=t('<div id="fancybox-overlay"></div>'),o=t('<div id="fancybox-wrap"></div>'));r=t('<div id="fancybox-outer"></div>').append('<div class="fancybox-bg" id="fancybox-bg-n"></div><div class="fancybox-bg" id="fancybox-bg-ne"></div><div class="fancybox-bg" id="fancybox-bg-e"></div><div class="fancybox-bg" id="fancybox-bg-se"></div><div class="fancybox-bg" id="fancybox-bg-s"></div><div class="fancybox-bg" id="fancybox-bg-sw"></div><div class="fancybox-bg" id="fancybox-bg-w"></div><div class="fancybox-bg" id="fancybox-bg-nw"></div>').appendTo(o);r.append(s=t('<div id="fancybox-content"></div>'),d=t('<a id="fancybox-close"></a>'),f=t('<div id="fancybox-title"></div>'),c=t('<a href="javascript:;" id="fancybox-left"><span class="fancy-ico" id="fancybox-left-ico"></span></a>'),l=t('<a href="javascript:;" id="fancybox-right"><span class="fancy-ico" id="fancybox-right-ico"></span></a>'));d.click(t.fancybox.close);n.click(t.fancybox.cancel);c.click(function(e){e.preventDefault();t.fancybox.prev()});l.click(function(e){e.preventDefault();t.fancybox.next()});if(t.fn.mousewheel){o.bind("mousewheel.fb",function(e,i){if(S){e.preventDefault()}else if(t(e.target).get(0).clientHeight==0||t(e.target).get(0).scrollHeight===t(e.target).get(0).clientHeight){e.preventDefault();t.fancybox[i>0?"prev":"next"]()}})}if(!t.support.opacity){o.addClass("fancybox-ie")}if(D){n.addClass("fancybox-ie6");o.addClass("fancybox-ie6");t('<iframe id="fancybox-hide-sel-frame" src="'+(/^https/i.test(window.location.href||"")?"javascript:void(false)":"about:blank")+'" scrolling="no" border="0" frameborder="0" tabindex="-1"></iframe>').prependTo(r)}};t.fn.fancybox.defaults={padding:10,margin:40,opacity:false,modal:false,cyclic:false,scrolling:"auto",width:560,height:340,autoScale:true,autoDimensions:true,centerOnScroll:false,ajax:{},swf:{wmode:"transparent"},hideOnOverlayClick:true,hideOnContentClick:false,overlayShow:true,overlayOpacity:.7,overlayColor:"#777",titleShow:true,titlePosition:"float",titleFormat:null,titleFromAlt:false,transitionIn:"fade",transitionOut:"fade",speedIn:300,speedOut:300,changeSpeed:300,changeFade:"fast",easingIn:"swing",easingOut:"swing",showCloseButton:true,showNavArrows:true,enableEscapeButton:true,enableKeyboardNav:true,onStart:function(){},onCancel:function(){},onComplete:function(){},onCleanup:function(){},onClosed:function(){},onError:function(){}};t(document).ready(function(){t.fancybox.init()})})(e)});